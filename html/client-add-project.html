<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>DevConnect</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
    <link href="../tabulator-master/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="../tabulator-master/dist/js/tabulator.min.js"></script>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- Favicons -->
    <link href="../img/favicon.png" rel="icon">
    <link href="../img/apple-touch-icon.png" rel="apple-touch-icon">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700|Open+Sans:300,300i,400,400i,700,700i" rel="stylesheet">
    <!-- Main Stylesheet File -->
    <link href="../css/signup.css" rel="stylesheet">
    <style type="text/css">
        .gradient-background {
            background: #000000;  /* fallback for old browsers */
            background: -webkit-linear-gradient(to right, #434343, #000000);  /* Chrome 10-25, Safari 5.1-6 */
            background: linear-gradient(to right, #434343, #000000); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
        }

        .in-progress{
            background-color: lightgreen;
            color: black;
        }

        .pending{
            background-color: lightyellow;
            color: black;
        }

        .finished{
            background-color: lightpink;
            color: black;
        }

    </style>

</head>

<body>
<header id="header" class="header-fixed">
    <div class="container" style="width: 100%; height: 100%">
        <div id="logo" class="pull-left">
            <h1><a href="index.html" class="scrollto">DevConnect</a></h1>
        </div>

        <nav id="nav-menu-container">
            <ul class="nav-menu">
                <li><a href="#">Profile</a></li>
                <li><a href="#">Logout</a></li>
            </ul>
        </nav><!-- #nav-menu-container -->
    </div>
</header><!-- #header -->

<div class="jumbotron gradient-background" style="margin-top: 72px">
    <h2 class="display-6" style="text-align: center; margin-bottom: 30px; color: white">Hello Client, 0000@gmail.com</h2>
    <div class="align-content-center">
        <div class="row justify-content-md-center vertical-center">
            <div class="col col-auto"><button class="btn btn-outline-warning" onclick="location.href='client.html'">Main</button></div>
            <div class="col col-auto"><button class="btn btn-outline-warning" onclick="location.href='client-profile.html'">Edit Profile</button></div>
            <div class="col col-auto"><button class="btn btn-outline-warning" onclick="location.href='client-add-project.html'">Add Project</button></div>
        </div>
    </div>
</div>
<div class="container-fluid" style="margin: 20px">
    <form onsubmit="return false;" id="project-register">
        <div class="row">
            <div class="col">
                <h2>Request New Project</h2>
                <div class="form-row">
                    <div class="col-sm-8 mb-3">
                        <label for="name">Project Name</label>
                        <input type="text" class="form-control" id="name" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-sm-8 mb-3">
                        <label for="start-date">Start Date</label>
                        <input type="date" class="form-control" id="start-date" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-sm-8 mb-3">
                        <label for="end-date">End Date</label>
                        <input type="date" class="form-control" id="end-date" required>
                    </div>
                </div>
                <!--<div class="form-row">-->
                    <!--<div class="col-sm-8 mb-3">-->
                        <!--<label for="pay">Pay</label>-->
                        <!--<input type="number" class="form-control" id="pay" required>-->
                    <!--</div>-->
                <!--</div>-->
                <label for="pay">Pay</label>
                <div class="form-row input-group col-sm-8" style="padding:0;margin-bottom: 20px">
                    <div class="input-group-prepend">
                        <span class="input-group-text">￦</span>
                    </div>
                    <input type="text" id="pay" class="form-control" aria-label="Amount (to the nearest dollar)" required>
                    <div class="input-group-append">
                        <span class="input-group-text">.00</span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="col-sm-8 mb-3">
                        <label for="yoe">Years of Experience</label>
                        <small class="text-muted">| Minimum years of experience required for the project</small>
                        <input type="number" class="form-control" id="yoe" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-sm-8 mb-3">
                        <label for="min-worker">Min Worker</label>
                        <small class="text-muted">| Minimum number of workers assigned to project</small>
                        <input type="number" class="form-control" id="min-worker" required>
                    </div>
                    <div class="col-sm-8 mb-3">
                        <label for="max-worker">Max Worker</label>
                        <small class="text-muted">| Maximum number of workers assigned to project</small>
                        <input type="number" class="form-control" id="max-worker" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-sm-8 mb-3">
                        <label for="doc">Project Document</label>
                        <input type="file" class="form-control" id="doc">
                    </div>
                </div>
                <div>
                    <label for="language">Select Languages To Request</label>
                    <select id="language" class="selectpicker" multiple data-live-search="true">
                        <option>Python</option>
                        <option>Java</option>
                        <option>Javascript</option>
                        <option>Go</option>
                        <option>C</option>
                        <option>Perl</option>
                        <option>C++</option>
                        <option>Swift</option>
                        <option>PHP</option>
                        <option>LISP</option>
                        <option>Kotlin</option>
                    </select>
                </div>

                <div id="language-proficiency" style="margin-top: 5px">
                    <label for="language">Enter Language Proficiency</label><br>
                    <small>Input value in range 0-10</small>
                </div>

                <button class="btn btn-outline-primary" id="add-project" onclick="registerProject()">Add Project</button>
            </div>
        </div>
    </form>
    <script type="text/javascript">
        const ajax = axios.create({
            baseURL: 'https://dev-connect-yonsei.herokuapp.com/api',
            headers: {'Access-Control-Allow-Origin': '*'}
        });

        function registerProject(){
            let name = $('#name').val();
            let start_date = $('#start-date').val();
            let end_date = $('#end-date').val();
            let pay = $('#pay').val();
            let yoe = $('#yoe').val();
            let min_worker = $('#min-worker').val();
            let max_worker = $('#max-worker').val();
            let language = [];
            let language_idx = {
                'Python':1,
                'Java':2,
                'Javascript': 3,
                'C': 4,
                'C++':5,
                'Perl':6,
                'Go':7,
                'SWIFT': 8,
                'PHP': 9,
                'Kotlin': 10
            };
            for(let i=0; i<proficiency.length; i++){
                let l = {
                    language_idx: language_idx[proficiency[i].language_name],
                    proficiency: proficiency[i].proficiency
                };
                language.push(l);
            }

            // Request Document 안넣음...
            ajax.post('/client/project/register', {
                client_idx: localStorage.getItem('client_idx'),
                name: name,
                start_date: start_date,
                end_date: end_date,
                pay: pay,
                experience: yoe,
                min_part: min_worker,
                max_part: max_worker,

            })
                .then(function (response) {
                    if(response.data.success == true){
                        alert('Project Registration Complete');
                        window.location.href = 'client.html'
                    } else {
                        invalid('Signup failed, please try again')
                    }
                })
                .catch(function (error) {
                    invalid(error.toString());
                    console.log(error);
                });

        }
        function invalid(msg){
            let output = `<div class="alert alert-danger" role="alert">${msg}</div>`;
            $('#project-register').append(output);
        }

        $('#language').on('change',function(){
            let language = $('#language').val();
            let language_data = [];

            for(let i=0; i<language.length; i++){
                language_data.push({
                    language_name: language[i],
                    proficiency: ''
                });
            }
            table = new Tabulator("#language-proficiency", {
                height:100,
                width: 300,// set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
                data: language_data, //assign data to table
                layout:"fitColumns", //fit columns to width of table (optional)
                columns:[ //Define Table Columns
                    {title:"Language Name", field:"language_name", width:150},
                    {title:"Proficiency", field:"proficiency", width:150, editor:"number", editorParams:{
                            min:0,
                            max:10,
                            step:1,
                        }
                    }
                ]
            });


        });


    </script>
</div>
</body>
</html>